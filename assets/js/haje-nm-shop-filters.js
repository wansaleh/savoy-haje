!function($){"use strict";$.extend($.nmTheme,{filters_init:function(){var e=this;e.$shopFilterMenu=$("#nm-shop-filter-menu"),e.$shopSidebarPopupBtn=$("#nm-shop-sidebar-popup-button"),e.shopSidebarLayout=$("#nm-shop-sidebar").data("sidebar-layout"),e.filterPanelSliding=!1,e.filterPanelSlideSpeed=200,e.filterPanelHideWidth=551,e.shopFilterMenuFnNames={cat:"shopFiltersCategoriesToggle",filter:"shopFiltersSidebarToggle",search:"shopFiltersSearchToggle"},e.shopFiltersBind(),$(".nm-shop-sub-categories").addClass("in")},shopFiltersBind:function(){var e=this;if(e.$shopFilterMenu.find("a").bind("click",function(s){if(s.preventDefault(),!e.filterPanelSliding){e.shopRemoveNotices(),e.filterPanelSliding=!0;var o=0,t=$(this).parent("li"),i=t.data("panel");t.hasClass("active")||(o=e.shopFiltersHideActivePanel()),t.toggleClass("active"),setTimeout(function(){var s=e.shopFilterMenuFnNames[i];e[s]()},o)}}),e.filtersEnableAjax&&e.$pageIncludes.hasClass("shop_categories")&&(e.subCategoriesClicked=!1,e.$shopWrap.on("click","#nm-shop-categories a",function(s){s.preventDefault(),e.subCategoriesClicked=$(this).closest(".nm-shop-sub-categories, #nm-shop-categories").hasClass("nm-shop-sub-categories");var o=$(this),t=o.parent("li");e.searchEnabled&&e.$searchBtn.parent("li").hasClass("active")&&(e.categoryClicked=!0,e.$searchBtn.trigger("click")),$("#nm-shop-categories").children(".current-cat").removeClass("current-cat"),t.addClass("current-cat"),e.shopGetPage(o.attr("href"))})),e.$shopSidebarPopupBtn.length){e.$shopSidebarPopup=$("#nm-shop-sidebar-popup");var s=null;e.$window.bind("scroll.nmShopPopupBtn resize.nmShopPopupBtn",function(){s&&clearTimeout(s),s=setTimeout(function(){e.$body.hasClass("shop-filters-popup-open")||e.shopFiltersPopupButtonToggle()},500)}),e.$shopSidebarPopupBtn.bind("click",function(){e.shopFiltersPopupShow()}),$("#nm-shop-sidebar-popup-reset-button").bind("click",function(s){s.preventDefault(),e.shopFiltersPopupReset()})}var o=!e.isTouch,t=!1;e.$shopWrap.on("click","#nm-shop-sidebar .nm-widget-title",function(s){var i=$(this).closest("li");if(i.hasClass("show"))o&&i.children(".nm-shop-widget-col").last().css("height",""),i.removeClass("show");else{var a=i.parent("#nm-shop-widgets-ul").children(".show");if(o){var n=i.children(".nm-shop-widget-col").last(),p=n.children().first().outerHeight(!0)+"px",r=a.children(".nm-shop-widget-col").last();n.css("height",p),r.css("height",""),t||(t=!0,e.$window.one("resize.nmShopWidget",function(){e.shopFiltersWidgetHideOpen(),t=!1}))}a.removeClass("show"),i.addClass("show")}}),e.filtersEnableAjax&&e.$pageIncludes.hasClass("shop_filters")&&(e.$shopWrap.on("click","#nm-shop-sidebar .nm_widget a",function(s){s.preventDefault(),e.shopGetPage($(this).attr("href"))}),e.$shopWrap.on("click","#nm-shop-sidebar .widget_product_categories a",function(s){s.preventDefault(),e.shopGetPage($(this).attr("href"))}),e.$shopWrap.on("click","#nm-shop-sidebar .widget_layered_nav a",function(s){s.preventDefault(),e.shopGetPage($(this).attr("href"))}),e.$shopWrap.on("click","#nm-shop-sidebar .widget_layered_nav_filters a",function(s){s.preventDefault(),e.shopGetPage($(this).attr("href"))}),e.$shopWrap.on("click","#nm-shop-sidebar .widget_product_tag_cloud a",function(s){s.preventDefault(),e.shopGetPage($(this).attr("href"),!1,!0)}),e.$shopWrap.on("click","#nm-shop-sidebar .widget_rating_filter a",function(s){s.preventDefault(),e.shopGetPage($(this).attr("href"))}))},shopFiltersCategoriesToggle:function(){var e=this;$("#nm-shop-categories").slideToggle(e.filterPanelSlideSpeed,function(){var s=$(this);s.toggleClass("fade-in"),s.hasClass("fade-in")||s.removeClass("force-show").css("display",""),e.filterPanelSliding=!1})},shopFiltersCategoriesReset:function(){$("#nm-shop-categories").removeClass("fade-in force-show").css("display","")},shopFiltersSidebarToggle:function(){var e=this,s=$("#nm-shop-sidebar"),o=s.is(":visible");o&&s.removeClass("fade-in"),s.slideToggle(e.filterPanelSlideSpeed,function(){o||s.addClass("fade-in"),e.filterPanelSliding=!1})},shopFiltersWidgetHideOpen:function(){var e=$("#nm-shop-widgets-ul").children(".show");e.length&&e.find(".nm-widget-title").trigger("click")},shopFiltersSearchToggle:function(){var e=this;e.searchPanelToggle(),e.currentSearch=""},shopFiltersHideActivePanel:function(){var e=this,s=0,o=e.$shopFilterMenu.children(".active");if(o.length){o.removeClass("active");var t=o.data("panel");if(o.is(":hidden")&&"cat"==t)e.shopFiltersCategoriesReset();else{s=300;var i=e.shopFilterMenuFnNames[t];e[i]()}}return s},shopFiltersPopupButtonToggle:function(){var e=this,s=e.$shopSidebarPopupBtn.hasClass("visible")?e.$shopSidebarPopupBtn.offset().top+e.$shopSidebarPopupBtn.outerHeight(!0):e.$shopSidebarPopupBtn.offset().top,o=e.$shopBrowseWrap.offset().top,t=190;s>o+t?e.shopFiltersPopupButtonShow():e.shopFiltersPopupButtonHide()},shopFiltersPopupButtonShow:function(){var e=this;e.$shopSidebarPopupBtn.addClass("visible")},shopFiltersPopupButtonHide:function(){var e=this;e.$shopSidebarPopupBtn.removeClass("visible")},shopFiltersPopupShow:function(){var e=this;e.shopFiltersPopupButtonHide(),e.$shopSidebarPopup.addClass("visible"),e.$body.addClass("shop-filters-popup-open"),e.$document.bind("mouseup.filtersPopup",function(s){e.$shopSidebarPopup.is(s.target)||0!==e.$shopSidebarPopup.has(s.target).length||e.shopFiltersPopupHide()})},shopFiltersPopupHide:function(){var e=this;e.$shopSidebarPopup.removeClass("visible"),e.shopFiltersPopupButtonToggle(),e.$body.removeClass("shop-filters-popup-open"),e.$document.unbind("mouseup.filtersPopup"),setTimeout(function(){$("#nm-shop-search-input").val(""),e.shopSearchHideNotice()},e.panelsAnimSpeed)},shopFiltersPopupReset:function(){var e=this,s=location.href.replace(location.search,"");e.shopGetPage(s),e.shopFiltersPopupHide()},shopExternalGetPage:function(e){var s=this;if(e==window.location.href)s.shopScrollToTop();else{$("#nm-shop-categories").children(".current-cat").removeClass("current-cat");var o=s.shopScrollToTop();setTimeout(function(){s.shopGetPage(e)},o)}},shopGetPage:function(e,s,o){var t=this;if(t.shopAjax)return!1;if(e){if(t.shopRemoveNotices(),"popup"==t.shopSidebarLayout&&t.shopFiltersPopupHide(),t.$body.width()<t.filterPanelHideWidth){t.shopShowLoader(!0);var i=t.filterPanelSlideSpeed;t.filterPanelSlideSpeed=0,t.shopFiltersHideActivePanel(),t.filterPanelSlideSpeed=i}else t.shopShowLoader();e=e.replace(/\/?(\?|#|$)/,"/$1"),s||t.setPushState(e),t.subCategoriesClicked||$(".nm-shop-sub-categories").removeClass("in"),t.shopAjax=$.ajax({url:e,data:{shop_load:"full",shop_filters_layout:t.shopSidebarLayout},dataType:"html",cache:!1,headers:{"cache-control":"no-cache"},method:"POST",error:function(e,s,o){console.log("NM: AJAX error - shopGetPage() - "+o),t.shopHideLoader(),t.shopAjax=!1},success:function(e){t.shopUpdateContent(e),t.shopAjax=!1}})}},shopUpdateContent:function(e){var s=this,o=$("<div>"+e+"</div>");if(nm_wp_vars.shopAjaxUpdateTitle){var t=o.find("#nm-wp-title").text();t.length&&(document.title=t)}var i=o.find("#nm-shop-categories"),a=o.find("#nm-shop-widgets-ul"),n=o.find("#nm-shop-browse-wrap");if(i.length){var p=$("#nm-shop-categories");p.hasClass("fade-in")&&i.addClass("fade-in force-show"),p.replaceWith(i),s.subCategoriesClicked?$(".nm-shop-sub-categories").addClass("in"):setTimeout(function(){$(".nm-shop-sub-categories").addClass("in")},10)}if(a.length){var r=$("#nm-shop-widgets-ul");r.replaceWith(a)}n.length&&s.$shopBrowseWrap.replaceWith(n),s.$shopBrowseWrap=$("#nm-shop-browse-wrap"),s.shopLoadImages(),s.shopInfLoadBound||s.infload_init();var l=s.shopScrollToTop();setTimeout(function(){s.shopHideLoader()},l)}}),$.nmThemeExtensions.filters=$.nmTheme.filters_init}(jQuery);